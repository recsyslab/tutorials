# VirtualBoxの環境設定

## 環境設定
1. **ファイル > 環境設定**を開く。
   1. 下記を設定し、**OK**ボタンをクリックする。
      - **一般 > デフォルトの仮想マシンフォルダー**: `D:\VirtualBox VMs` # 外付けSSDのドライブ
      - **入力 > 仮想マシン > ホストキーの組み合わせ**: `Left Windows`
        - **ホストキーの組み合わせ**の右のボックスをクリックした状態で、キーボードの**Windows**キーを押す。
      - **言語 > インターフェース言語**: `日本語（日本）`

## 仮想マシンの設定
1. 対象の仮想マシンを選択し、**設定**ボタンをクリックする。
   1. **設定**ダイアログで下記を設定する。
      - **一般 > 高度 > クリップボードの共有**: `双方向`
      - **一般 > 高度 > ドラッグ&ドロップ**: `双方向`
      - **システム > マザーボード > メインメモリー**: （`4096 MB` 以上推奨）
      - **システム > プロセッサー > Processors**: （`2 CPU` 以上推奨）
      - **ディスプレイ > スクリーン > ビデオメモリー**: `128MB`
        - ディスプレイ数やビデオメモリを多くしすぎると仮想マシンが起動しなかったり、画面がおかしくなったりすることがある。仮想マシンが正常に起動する範囲で、それぞれ設定すると良い。
      - **ディスプレイ > スクリーン > ディスプレイ数**: （`2` 推奨）
      - **ディスプレイ > スクリーン > グラフィックスコントローラー**: `VMSVGA`
        - 他のコントローラーを選択すると、マルチディスプレイが使えないことがある。
        - ENVYの場合は、VBoxVGAを選択すると無効になるので、VMSVGAを選択する。
        - ProBook 430の場合は、VBoxVGA（VMSVGA）？
      - **ディスプレイ > スクリーン > 拡張機能 > 3Dアクセラレーションを有効化**: `チェック`
      - **ディスプレイ > レコーディング > レコーディングを有効化**: `非チェック`
      - **共有フォルダー**
        - 右の**共有フォルダーの追加**ボタンをクリックし、下記を設定し、**OK**ボタンをクリックする。
          - **フォルダーのパス**: `C:`
          - **フォルダー名**: `C_DRIVE`
          - **マウントポイント**: `/mnt/c/`
          - **自動マウント**: `チェック`
        - （外付けSSDを参照する場合）右の**共有フォルダーの追加**ボタンをクリックし、下記を設定し、**OK**ボタンをクリックする。
          - **フォルダーのパス**: `D:`
          - **フォルダー名**: `D_DRIVE`
          - **マウントポイント**: `/mnt/d/`
          - **自動マウント**: `チェック`
   2. **OK**ボタンをクリックする。

#### 参考
- PC設定のカルマ, [VirtualBoxでOS間のクリップボードを共有する方法](https://pc-karuma.net/virtualbox-clipboard-share/)

## Guest Additionsのインストール
1. 対象の仮想マシンを選択し、**起動**ボタンをクリックする。
   1. Linuxにログインする。
   2. Virtual Boxのメニューから**デバイス > Guest Additions CD イメージの挿入**を開く。
   3. デスクトップに現れた`VBox_GAs_7.＊.＊＊`を開く。
   4. 開かれたフォルダ内の`autorun.sh`をダブルクリックする。
      1. **実行**ボタンをクリックする。
         - ...（1分程度）...
      2. 「Press Return to close this window」と表示されたら**ENTER**キーを押す。
   5. `VBox_GAs_7.＊.＊＊`を右クリックし、**取り出す**を選択する。
   6. Linuxを再起動する。
      - ウィンドウサイズを変更したときに、Linuxの画面が自動的にリサイズされることを確認する。
        - リサイズされない場合は、Virtual Boxのメニューから**表示 > ゲストOSの画面を自動リサイズ**を選択する。
      - Windows <-> Linuxの双方向にクリップボードが共有されることを確認する。
   7. Linuxを終了する。

## 仮想マシンのスナップショットの作成
※ 仮想マシンのスナップショットを作成しておくことで、いつでもその状態まで復元することができる。

1. **仮想マシン > ツール > スナップショット**を開く。
2. 対象の仮想マシンを選択し、**作成**ボタンをクリックする。
   1. 下記を設定し、**OK**ボタンをクリックする。
      - **スナップショットの名前**: `クリーンインストール`

## 仮想マシンのクローン
※ 仮想マシンを他のPCに移行する場合は、仮想マシンのクローンを利用する。

1. 作成したスナップショットを選択し、**クローン**ボタンをクリックする。
   1. 下記を設定し、**次へ**ボタンをクリックする。
      - **名前**: `クリーンインストールのクローン`
      - **パス**: （任意）
   2. **すべてをクローン**を選択し、**次へ**ボタンをクリックする。
   3. **現在のマシンの状態**を選択し、**完了**ボタンをクリックする。
      - ...（15分程度）...
