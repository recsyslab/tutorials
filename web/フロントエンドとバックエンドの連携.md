# フロントエンドとバックエンドの連携

## フロントエンドの実装

### VSCodeの起動
```bash
$ cd ~/dev/app/frontend/
$ code .
```

### hello/page.tsxの作成
`frontend/app/`ディレクトリに`hello`ディレクトリを作成する。
`~/dev/app/frontend/app/hello/`

作成した`hello/`ディレクトリに`page.tsx`を作成し、下記コードを記述する。
`~/dev/app/frontend/app/hello/page.tsx`
```tsx
export default function Page() {
    return <h1>Hello, Next.js!</h1>
}
```

```bash
$ cd ~/dev/app/frontend/
$ yarn dev
```

ブラウザで http://localhost:3000/hello にアクセスし、「Hello, Next.js」が表示されれば成功。

### Next.js上でのAPIの用意
`frontend/`ディレクトリに`pages/api/`ディレクトリを作成する。
`~/dev/app/frontend/pages/api/`

作成した`api/`ディレクトリに`hello.ts`を作成し、下記コードを記述する。
`~/dev/app/frontend/pages/api/hello.ts`
```ts
import type { NextApiRequest, NextApiResponse } from 'next'

type Data = {
    name: string
}

export default function handler(
    req: NextApiRequest,
    res: NextApiResponse<Data>
) {
    res.status(200).json({ name: 'John Doe' })
}
```

ブラウザで http://localhost:3000/api/hello にアクセスし、「{"name":"John Doe"}」が表示されれば成功。

※うまく表示されない場合は、サーバを再起動してみる。

### Next.js上でのAPI通信
`frontend/app/`ディレクトリに`hello_frontend_fetch/`ディレクトリを作成する。
`~/dev/app/frontend/app/hello_frontend_fetch/`

作成した`hello_frontend_fetch/`ディレクトリに`page.tsx`を作成し、下記コードを記述する。
`~/dev/app/frontend/app/hello/page.tsx`
```tsx


`frontend/`ディレクトリに`pages/api/`ディレクトリを作成する。
`~/dev/app/frontend/pages/api/`

作成した`api/`ディレクトリに`hello.ts`を作成し、下記コードを記述する。
`~/dev/app/frontend/pages/api/hello.ts`
```tsx
'use client'

import { useState, useEffect } from 'react'

export default function Page() {
    const [data, setData] = useState({ name: '' })

    useEffect(() => {
        fetch('/api/hello')
            .then((res) => res.json())
            .then((data) => {
                setData(data)
            })

    }, [])
    return <div>hello {data.name}!</div>
}
```

ブラウザで http://localhost:3000/hello_frontend_fetch にアクセスし、「hello John Doe!」が表示されれば成功。

※うまく表示されない場合は、サーバを再起動してみる。
